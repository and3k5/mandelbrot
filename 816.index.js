var Mandelbrot;(()=>{"use strict";(()=>{class t{constructor(){this.colorMap=t.COLORMAP.DEFAULT,this.maxIteration=1024,this.width=100,this.height=100}toObj(){return{width:this.width,height:this.height,maxIteration:this.maxIteration,colorMap:this.colorMap.name}}getIterations(){const t=this.width,e=this.height,a=this.maxIteration;let o,r=0;const n=[];for(let s,i=0;i<e;i++)for(s=0;s<t;s++){o=0;let h=0,c=0;for(;o++<a;){const a=h*h-c*c+((s<<1)-1.5*t)/t;if(c=2*h*c+((i<<1)-e)/e,h=a,h*h+c*c>4)break}n[r++]=o}return n}async renderElement(t){const e=t.getContext("2d"),a=e.createImageData(this.width,this.height),o=this.getIterations();for(let t=0,e=o.length;t<e;t++){const e=this.colorMap(o[t]);a.data[4*t+0]=e[0],a.data[4*t+1]=e[1],a.data[4*t+2]=e[2],a.data[4*t+3]=255}e.putImageData(a,0,0)}renderBuffer(t){const e=new Uint8Array(t),a=this.getIterations();for(let t=0,o=a.length;t<o;t++){const o=this.colorMap(a[t]);e[4*t+0]=o[0],e[4*t+1]=o[1],e[4*t+2]=o[2],e[4*t+3]=255}}}t.COLORMAP={},t.COLORMAP.COLORED=function(t){const e=[0,0,0];if(t!=this.maxIteration){const a=3*Math.log(t)/Math.log(this.maxIteration-1);return a<1?(e[0]=255*a,e):(e[0]=255,e[1]=255,a<2?e[1]*=a-1:e[2]=255*(a-2),e)}return e},t.COLORMAP.DEFAULT=function(t){const e=t/this.maxIteration*255&255;return[e,e,e]};let e=null;self.onmessage=({data:a})=>{switch(a.cmd){case 0:const o=a.mandelbrot,r=new t;for(const t in o)r[t]=o[t];r.colorMap=t.COLORMAP[r.colorMap],e=r;break;case 1:const n=a.buffer;e.renderBuffer(n),postMessage({cmd:2})}}})(),Mandelbrot={}})();